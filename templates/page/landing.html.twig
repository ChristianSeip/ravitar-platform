{% extends 'base.html.twig' %}

{% block title %}Startseite{% endblock %}

{% block content %}
    <section class="relative overflow-hidden bg-gradient-to-br from-[var(--color-primary-700)] via-[var(--color-primary-500)] to-[var(--color-accent-500)] clip-hero">
        <div class="absolute inset-0 overflow-hidden">
            <div class="absolute top-0 -left-24 w-64 h-64 bg-[var(--color-primary-300)]/30 rounded-full animate-float"></div>
            <div class="absolute -bottom-24 right-0 w-72 h-72 bg-[var(--color-accent-100)]/30 rounded-full animate-float animate-delay-200"></div>
        </div>

        <div class="container mx-auto px-4 py-24 lg:py-32 relative z-10 text-center">
            <h1 class="text-5xl md:text-6xl font-extrabold text-white leading-tight animate-fade-in-up">Willkommen bei Ravitar</h1>
            <p class="mt-4 text-xl md:text-2xl text-white/90 animate-fade-in-up animate-delay-200">
                Deine Plattform für Entwickler, Admins & Tech-Interessierte
            </p>

            <div class="mt-8 flex flex-col items-center sm:flex-row sm:justify-center gap-4 animate-fade-in-up animate-delay-400">
                <a href="{{ path('blog_post_list') }}" class="btn-contrast text-center">Beiträge entdecken</a>
                <a href="https://forum.ravitar.com" class="btn-secondary text-center">Zur Community</a>
            </div>
        </div>
    </section>

    <div class="section-diagonal no-section-bottom"></div>

    <section class="mt-12 py-16">
        <div class="container mx-auto px-4 lg:px-8">
            <h2 class="text-3xl font-bold mb-8 text-center text-[var(--color-text)] animate-fade-in-up">Aktuelle Blog-Beiträge</h2>

            <div class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-3 auto-rows-fr gap-8">
                {% set maxCols = 3 %}
                {% set maxRows = 2 %}
                {% set currentRow = 1 %}
                {% set currentRowCols = 0 %}

                {% for post in latestBlogPosts %}
                    {% set isFirst = loop.first %}
                    {% set desiredCols = isFirst ? 2 : post.gridCols %}
                    {% set desiredRows = post.gridRows %}
                    {% set charLen = isFirst ? 300 : 150 %}

                    {% if currentRowCols + desiredCols > maxCols %}
                        {% set currentRow = currentRow + 1 %}
                        {% set currentRowCols = 0 %}
                    {% endif %}

                    {% if currentRow > maxRows %}
                        {# NICHTS anzeigen #}
                    {% else %}
                        {% set availableCols = maxCols - currentRowCols %}
                        {% set cols = desiredCols > availableCols ? availableCols : desiredCols %}
                        {% set rows = desiredRows %}
                        {% set currentRowCols = currentRowCols + cols %}

                        {% set spanClasses = [
                            'md:col-span-' ~ cols,
                            'md:row-span-' ~ rows,
                            'lg:col-span-' ~ cols,
                            'lg:row-span-' ~ rows
                        ]|join(' ') %}

                        <article class="card-hover animate-fade-in-up animate-delay-{{ loop.index0 * 150 }} {{ spanClasses }}">
                            <a href="{{ path('blog_post_show', {slug: post.slug}) }}">
                                <h3 class="text-{{ isFirst ? '2xl font-bold' : 'xl font-semibold' }} mb-2 text-[var(--color-text)]">
                                    {{ post.title }}
                                </h3>
                                <p class="text-[var(--color-gray-600)] mb-4">{{ post.excerpt|slice(0, charLen) ~ (post.excerpt|length > charLen ? '…' : '') }}</p>
                                <div class="text-sm text-[var(--color-gray-400)] mb-3">{{ post.createdAt|date('d.m.Y H:i') }}</div>
                                <span class="link-primary">Weiterlesen</span>
                            </a>
                        </article>
                    {% endif %}
                {% endfor %}
            </div>
        </div>
    </section>

    <section class="mt-12 py-16 bg-white">
        <div class="container mx-auto px-4 lg:px-8">
            <h2 class="text-3xl font-bold mb-6 text-center text-[var(--color-text)] animate-fade-in-up">Heiße Themen im Forum</h2>
            <ul class="space-y-4">
                {% for topic in hotTopics %}
                    <li class="forum-item animate-fade-in-up">
                        <a href="{{ topic.url }}" class="block w-full h-full">
                            <h3 class="text-lg font-medium text-[var(--color-gray-800)] hover:text-[var(--color-primary-500)] transition-colors">
                                {{ topic.title }}
                            </h3>
                            {# <span class="text-sm text-[var(--color-gray-500)]">{{ topic.replies }} Antworten</span> #}
                        </a>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </section>

    <section class="mt-12 bg-white py-16">
        <div class="container mx-auto px-4 lg:px-8 grid grid-cols-1 md:grid-cols-2 gap-12 items-center">
            <div class="animate-fade-in-up">
                <h2 class="text-3xl font-bold mb-4 text-[var(--color-text)]">Was ist Ravitar?</h2>
                <p class="text-[var(--color-gray-700)] leading-relaxed mb-4">
                    Ravitar ist eine Plattform für Entwickler, Admins und Technikbegeisterte, die mehr wollen als nur Antworten aus dem Netz.
                </p>
                <p class="text-[var(--color-gray-700)] leading-relaxed mb-4">
                    Wir stehen noch ganz am Anfang, aber die Vision ist klar: eine offene, respektvolle Community aufzubauen, in der Wissen nicht gehortet, sondern geteilt wird. Ein Ort, an dem du Fragen stellen, eigene Ideen zeigen und dich mit Menschen austauschen kannst, die deine Begeisterung für Technologie teilen.
                </p>
                <p class="text-[var(--color-gray-700)] leading-relaxed">
                    Ravitar wächst mit dir – Schritt für Schritt. Wenn du Lust hast, Teil davon zu sein: Willkommen.
                </p>
            </div>
        </div>
    </section>

{% endblock %}
