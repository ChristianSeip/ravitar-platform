<div class="px-8 py-6">
    {% if title is defined %}
        <h2 class="text-2xl font-semibold text-[var(--color-text)] mb-6">{{ title }}</h2>
    {% endif %}

    {% set final_form_attr = { class: 'space-y-6' }|merge(form_attr|default({})) %}
    {{ form_start(form, {
        method: form_method|default('post'),
        action: form_action|default(null),
        attr: final_form_attr,
        novalidate: form_novalidate|default(false),
        render_rest: form_render_rest|default(true)
    }) }}
    {{ form_errors(form) }}

    {% set default_widget_attr = {
        class: 'w-full rounded border border-gray-300 bg-gray-50 px-3 py-2 ' ~
        'focus:outline-none focus:ring focus:ring-[var(--color-primary-100)] focus:border-[var(--color-primary-500)]'
    } %}

    {% for field in form %}
        {% set opts       = field_options[field.vars.name]|default({}) %}
        {% set label      = opts.label      is defined ? opts.label      : null %}
        {% set label_html = opts.label_html is defined ? opts.label_html : false %}

        {% if 'csrf_token' in field.vars.block_prefixes %}
            {{ form_widget(field) }}

        {% elseif 'checkbox' in field.vars.block_prefixes %}
            <div class="flex items-center">
                {% set default_checkbox_attr = {
                    class: 'h-4 w-4 text-[var(--color-primary-500)] border-gray-300 rounded focus:ring-[var(--color-primary-500)]'
                } %}
                {% set checkbox_attr = default_checkbox_attr|merge(opts.widget_attr|default({})) %}
                {{ form_widget(field, { attr: checkbox_attr }) }}
                {{ form_label(field, label, {
                    label_html: label_html,
                    label_attr: opts.label_attr|default({ class: 'ml-2 block text-sm text-[var(--color-gray-700)]' })
                }) }}
            </div>
            {{ form_errors(field) }}

        {% else %}
            <div>
                {{ form_label(field, label, {
                    label_attr: opts.label_attr|default({ class: 'block text-sm font-medium text-[var(--color-gray-700)] mb-2' })
                }) }}

                {% set widget_attr = default_widget_attr|merge(opts.widget_attr|default({})) %}
                {{ form_widget(field, { attr: widget_attr }) }}

                {{ form_errors(field) }}
            </div>
        {% endif %}
    {% endfor %}

    <div class="pt-4">
        <button type="submit" class="btn-primary w-full text-center">{{ button_label|default('Absenden') }}</button>
    </div>

    {{ form_end(form) }}
</div>
